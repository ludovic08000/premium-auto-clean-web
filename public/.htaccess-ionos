
# Configuration MIME complète pour IONOS
<IfModule mod_mime.c>
  # Définir correctement les types MIME pour JavaScript
  AddType application/javascript .js
  AddType application/javascript .mjs
  AddType application/javascript .jsx
  AddType application/javascript .tsx
  
  # Définir correctement le type MIME pour XML
  AddType text/xml .xml
</IfModule>

# Force les types MIME pour JavaScript et XML
<FilesMatch "\.(js|mjs|jsx|tsx)$">
  ForceType application/javascript
  Header set Content-Type "application/javascript"
</FilesMatch>

<FilesMatch "\.(xml)$">
  ForceType text/xml
  Header set Content-Type "text/xml"
</FilesMatch>

# Redirection via PHP pour garantir les bons types MIME
<IfModule mod_rewrite.c>
  RewriteEngine On
  RewriteBase /
  
  # Traiter les fichiers XML avec le script PHP spécifique
  RewriteRule \.(xml)$ xml-proxy.php [L]
  
  # Traiter les fichiers JavaScript avec le script PHP spécifique
  RewriteRule \.(js|mjs|jsx|tsx)$ js-proxy.php [L]
  
  # Ne pas appliquer les règles aux fichiers et dossiers existants sauf JS et XML
  RewriteCond %{REQUEST_FILENAME} !-f [OR]
  RewriteCond %{REQUEST_URI} \.(js|mjs|jsx|tsx|xml)$
  
  # Rediriger les autres requêtes vers index.php pour traitement PHP des MIME types
  RewriteRule ^(.*)$ index.php [L]
</IfModule>

# Configuration des en-têtes pour tous les fichiers
<IfModule mod_headers.c>
  # Autoriser les requêtes cross-origin
  <FilesMatch ".*">
    Header set Access-Control-Allow-Origin "*"
    Header set Access-Control-Allow-Methods "GET, POST, OPTIONS"
    Header set Access-Control-Allow-Headers "Content-Type"
  </FilesMatch>
  
  # Configuration spécifique pour JavaScript
  <FilesMatch "\.(js|jsx|tsx|mjs)$">
    Header set Content-Type "application/javascript"
  </FilesMatch>
  
  # Configuration spécifique pour XML
  <FilesMatch "\.(xml)$">
    Header set Content-Type "text/xml"
  </FilesMatch>
</IfModule>
